# TaskDesk Project - Cursor Rules

## Project Overview
TaskDesk is a modern task management application built with Next.js 16, React 19, TypeScript, and Tailwind CSS 4.

## Tech Stack
- **Framework**: Next.js 16 (App Router)
- **UI Library**: React 19
- **Language**: TypeScript
- **Styling**: Tailwind CSS 4
- **Components**: shadcn/ui
- **Forms**: React Hook Form + Zod
- **Icons**: Lucide React
- **Themes**: next-themes (light/dark mode)
- **State Management**: Zustand
- **Notifications**: Sonner
- **Authentication**: Supabase Auth
- **Database**: Supabase (PostgreSQL)

## Core Principles

### 1. Component Variants Over Hardcoded Styles
- **NEVER** use hardcoded className strings for repeated patterns
- **ALWAYS** create variants in base components using `class-variance-authority`
- **ALWAYS** use semantic variant names (e.g., `social`, `auth`, `gradient`)

### 2. Type Safety
- **ALWAYS** use TypeScript for all files
- **ALWAYS** define proper interfaces for component props
- **ALWAYS** use `VariantProps` for variant-based components
- **NEVER** use `any` type

### 3. Code Style
- **NEVER** include comments in production code
- **ALWAYS** use descriptive variable and function names
- **ALWAYS** keep code clean and self-documenting
- **ALWAYS** remove console.logs before committing (except intentional logging)

### 4. File Organization
- Components in `components/` organized by type:
  - `components/ui/` - Base UI components (shadcn)
  - `components/features/` - Feature-specific components
  - `components/forms/` - Form components
  - `components/providers/` - Context providers (Theme, Auth, Root)
  - `components/layout/` - Layout components
- Constants in `lib/constants/`:
  - `routes.ts` - Application routes
  - `toast-messages.ts` - Toast notification messages
  - `config.ts` - Configuration values (delays, thresholds, etc.)
  - `index.ts` - Central export for all constants
- Each feature folder should have an `index.ts` for exports
- Keep related files together

### 5. Constants Usage
- **ALWAYS** use constants for routes, toast messages, and configuration values
- **ALWAYS** import constants from `@/lib/constants`
- **NEVER** hardcode routes, messages, or config values
- Use constants for values used in 2+ places or likely to change

## UI Component Patterns

### Button Variants

```tsx
// ✅ CORRECT - Use variants
<Button variant="social" size="auth">
  <Icon />
  <span>Text</span>
</Button>

<Button variant="gradient" size="auth" className="w-full">
  Submit
</Button>

// ❌ WRONG - Don't hardcode styles
<Button className="border bg-background shadow-xs border-border/50 hover:border-primary/50 hover:bg-primary/5">
```

**Available Button Variants:**
- `default` - Primary button (bg-primary)
- `destructive` - Destructive actions
- `outline` - Outlined button
- `secondary` - Secondary actions
- `ghost` - Ghost button
- `link` - Link style
- `social` - Social login buttons (Google, GitHub, etc.)
- `gradient` - Gradient primary actions (from-primary to-accent)

**Available Button Sizes:**
- `default` - 36px height
- `sm` - 32px height
- `lg` - 40px height
- `auth` - 44px height (for auth forms)
- `icon` - Square icon buttons

### Input Variants

```tsx
// ✅ CORRECT - Use variants
<Input variant="auth" inputSize="auth" />

// ❌ WRONG - Don't hardcode styles
<Input className="h-11 bg-background/50" />
```

**Available Input Variants:**
- `default` - Standard transparent background
- `auth` - Auth form inputs (bg-background/50)

**Available Input Sizes:**
- `default` - 36px height
- `auth` - 44px height (matches auth buttons)

### Creating New Variants

When you need a new pattern used in 2+ places:

1. Add variant to base component:
```tsx
const buttonVariants = cva(
  "base-classes",
  {
    variants: {
      variant: {
        newVariant: "specific-styles",
      },
    },
  }
)
```

2. Use the variant:
```tsx
<Button variant="newVariant">Click</Button>
```

## Authentication UI Patterns

### Auth Layout Structure
```tsx
<AuthLayout>
  <AuthContainer initialMode="signin" />
</AuthLayout>
```

### Auth Forms
- Use `AuthFormField` wrapper for form fields
- Include icons from lucide-react
- Use `variant="auth"` and `inputSize="auth"` for inputs
- Use `variant="social"` and `size="auth"` for social buttons
- Use `variant="gradient"` and `size="auth"` for submit buttons

### Example Auth Form Field
```tsx
<AuthFormField
  label="Email Address"
  icon={<Mail className="h-4 w-4" />}
  error={errors.email?.message}
>
  <Input
    type="email"
    variant="auth"
    inputSize="auth"
    {...register('email')}
    className="pl-10"
  />
</AuthFormField>
```

## Styling Guidelines

### Theme Variables
- Use CSS variables for colors: `var(--foreground)`, `var(--background)`, etc.
- **NEVER** hardcode color values
- Support both light and dark modes

### Hover States
- Ensure hover states work in both light and dark modes
- Use `!important` flags when necessary to override conflicting styles
- Test all interactive elements in both themes

### Focus States
- Input focus: `focus-visible:border-primary focus-visible:ring-2 focus-visible:ring-primary/20`
- Button focus: `focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]`

### Transitions
- Use `transition-all` for smooth state changes
- Use `transition-colors` for color-only changes
- Use `transition-opacity` for opacity changes
- Add `duration-200` or `duration-300` for custom timing

## Form Patterns

### Form Validation
- Use Zod schemas for validation
- Define schemas in separate `form-schema.ts` files
- Use React Hook Form with `zodResolver`

### Form State Management
```tsx
const {
  register,
  handleSubmit,
  formState: { errors },
} = useForm<FormData>({
  resolver: zodResolver(formSchema),
});
```

### Loading States
- Always disable buttons during loading
- Show loading spinner with appropriate text
- Disable form inputs during submission

### Loading States with Spinner Component
```tsx
import { Spinner } from '@/components/ui/spinner';

<Button disabled={isLoading}>
  {isLoading ? (
    <>
      <Spinner size="sm" variant="foreground" />
      <span>Loading...</span>
    </>
  ) : (
    <>
      <span>Submit</span>
      <ArrowRight className="h-4 w-4" />
    </>
  )}
</Button>
```

**Spinner Component:**
- Located in `components/ui/spinner.tsx`
- Sizes: `sm`, `default`, `lg`
- Variants: `default` (primary colors), `foreground` (primary-foreground for buttons)
- **ALWAYS** use this component instead of inline spinner markup

## Animation Guidelines

### Custom Animations
Define in `globals.css` under `@layer utilities`:

```css
@keyframes animationName {
  0%, 100% { /* styles */ }
  50% { /* styles */ }
}

.animate-animationName {
  animation: animationName 3s ease infinite;
}
```

### Animation Classes
- Use Tailwind's built-in: `animate-spin`, `animate-pulse`, `animate-ping`
- Custom delays: `.delay-500`, `.delay-1000`
- Custom gradient: `.animate-gradient`

## Global CSS Structure

```css
@layer base {
  /* Base element styles */
}

@layer utilities {
  /* Custom utilities and animations */
}

@layer components {
  /* Component-specific overrides */
}
```

## Import Organization

```tsx
// 1. External libraries
import React, { useState } from 'react';
import { useForm } from 'react-hook-form';

// 2. UI components
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Spinner } from '@/components/ui/spinner';

// 3. Feature components
import { AuthFormField } from '@/components/features/auth/auth-form-field';

// 4. Constants
import { ROUTES } from '@/lib/constants/routes';
import { TOAST_MESSAGES } from '@/lib/constants/toast-messages';
import { CONFIG } from '@/lib/constants/config';

// 5. Utils and schemas
import { signInSchema, type SignInFormData } from './form-schema';

// 6. Icons
import { Mail, Lock, Eye } from 'lucide-react';
```

## Component Structure

```tsx
'use client'; // Only if using client-side features

import statements...

interface ComponentProps {
  // Props definition
}

export function Component({ prop1, prop2 }: ComponentProps) {
  const [state, setState] = useState();
  
  const handleAction = () => {
    // Handler logic
  };
  
  return (
    <div>
      {/* JSX */}
    </div>
  );
}
```

## Naming Conventions

### Files
- Components: PascalCase (e.g., `AuthLayout.tsx`)
- Utils: kebab-case (e.g., `form-schema.ts`)
- Types: PascalCase with `.types.ts` suffix

### Components
- PascalCase: `AuthFormField`, `SignInForm`
- Descriptive names that indicate purpose

### Variables
- camelCase: `isLoading`, `handleSubmit`
- Boolean prefix: `is`, `has`, `should`
- Handlers prefix: `handle`, `on`

### Constants
- **ALWAYS** use constants from `lib/constants/` folder
- Import from `@/lib/constants` (uses index.ts barrel export)
- Constants are organized by type (routes, toast-messages, config)
- Use constants for:
  - Routes: `ROUTES.AUTH`, `ROUTES.TASKS`, etc.
  - Toast messages: `TOAST_MESSAGES.AUTH.SIGN_IN_SUCCESS`
  - Configuration: `CONFIG.REDIRECT_DELAY`, `CONFIG.HEADER_SCROLL_THRESHOLD`

## Responsive Design

### Breakpoints
- Mobile-first approach
- Use Tailwind breakpoints: `sm:`, `md:`, `lg:`, `xl:`, `2xl:`
- Test on mobile, tablet, and desktop

### Layout Patterns
```tsx
<div className="grid grid-cols-1 lg:grid-cols-2">
  <div className="order-2 lg:order-1">Form</div>
  <div className="hidden lg:flex order-1 lg:order-2">Features</div>
</div>
```

## Accessibility

### Form Labels
- Always use labels with form inputs
- Associate labels with inputs using `htmlFor` and `id`

### Focus Management
- Ensure keyboard navigation works
- Visible focus indicators
- Use `tabIndex={-1}` for decorative interactive elements

### ARIA Attributes
- Use `aria-invalid` for form errors
- Use `disabled` attribute for disabled states

## Performance

### Optimization
- Use `React.memo` for expensive components
- Avoid unnecessary re-renders
- Use proper key props in lists
- Lazy load heavy components when appropriate

### Best Practices
- Keep component files under 300 lines
- Extract complex logic to custom hooks
- Use TypeScript for type safety
- Minimize bundle size

## Error Handling

### Form Errors
```tsx
<AuthFormField error={errors.fieldName?.message}>
  <Input {...register('fieldName')} />
</AuthFormField>
```

### User Feedback
- Show clear error messages
- Use Sonner toast notifications for success/error states
- **ALWAYS** use constants from `TOAST_MESSAGES` for toast messages
- Disable submit during validation
- Example:
```tsx
import { toast } from 'sonner';
import { TOAST_MESSAGES } from '@/lib/constants/toast-messages';

toast.success(TOAST_MESSAGES.AUTH.SIGN_IN_SUCCESS);
toast.error(TOAST_MESSAGES.AUTH.SIGN_IN_ERROR);
```

## Security

### Input Validation
- Always validate on both client and server
- Use Zod schemas for type-safe validation
- Sanitize user input
- Never trust client-side validation alone

### Authentication
- Implement proper session management
- Use secure password handling
- Add CSRF protection
- Implement rate limiting

## Git Workflow

### Commits
- Use descriptive commit messages
- Follow conventional commits format
- Keep commits focused and atomic

### Branches
- Feature branches from main
- Name format: `feature/description` or `fix/description`

## Testing Approach

### What to Test
- Component rendering
- User interactions
- Form validation
- Error states
- Loading states

### Testing Tools
- Jest for unit tests
- React Testing Library for component tests
- Playwright/Cypress for E2E tests

## Common Patterns to Follow

### 1. Consistent Width Classes
```tsx
// Auth forms and containers
<div className="w-full max-w-md">

// Auth buttons
<Button variant="social" size="auth"> // w-full in variant

// Regular content
<div className="w-full max-w-7xl">
```

### 2. Spacing Patterns
```tsx
// Vertical spacing
<div className="space-y-4">    // Small gaps
<div className="space-y-6">    // Medium gaps
<div className="space-y-8">    // Large gaps

// Padding
<div className="p-4">          // Small padding
<div className="p-6">          // Medium padding
<div className="p-8">          // Large padding
```

### 3. Card Patterns
```tsx
<div className="relative p-8 rounded-2xl bg-card/50 backdrop-blur-xl border border-border shadow-2xl shadow-primary/5">
  <div className="absolute inset-0 rounded-2xl bg-gradient-to-br from-primary/20 via-transparent to-accent/20 -z-10 blur-xl" />
  {/* Content */}
</div>
```

## Anti-Patterns to Avoid

### ❌ Don't Do This

```tsx
// Don't hardcode styles
<Button className="w-full gap-3 h-11 border-border/50 hover:border-primary/50">

// Don't use inline styles
<div style={{ color: 'red' }}>

// Don't use any type
const data: any = fetchData();

// Don't leave comments in production code
{/* This is a button */}
<Button>Click</Button>

// Don't use magic numbers
<div className="w-[423px] h-[156px]">
```

### ✅ Do This Instead

```tsx
// Use variants
<Button variant="social" size="auth">

// Use Tailwind classes
<div className="text-destructive">

// Use proper types
const data: UserData = fetchData();

// Self-documenting code
<Button variant="submit">Submit Form</Button>

// Use semantic sizing
<div className="w-full max-w-md">
```

## Provider Structure

### Theme Provider
- Located in `components/providers/theme-provider.tsx`
- Handles theme management (light/dark mode)
- Includes Sonner Toaster component
- Wraps NextThemesProvider

### Auth Provider
- Located in `components/providers/auth-provider.tsx`
- Manages authentication state with Zustand
- Syncs with Supabase auth state changes
- Initializes store with server-provided user data

### Root Provider
- Located in `components/providers/root-provider.tsx`
- Composes ThemeProvider and AuthProvider
- Single entry point for all providers
- Used in `app/layout.tsx`

## State Management

### Zustand Store
- Located in `lib/stores/auth-store.ts`
- Global authentication state management
- Provides: `user`, `isAuthenticated`, `isLoading`
- Actions: `setUser`, `setLoading`, `clearAuth`
- **ALWAYS** use `useAuthStore()` hook to access auth state

### Example Usage
```tsx
import { useAuthStore } from '@/lib/stores/auth-store';

const { user, isAuthenticated, isLoading } = useAuthStore();
```

## Routing and Navigation

### Routes
- **ALWAYS** use `ROUTES` constants from `@/lib/constants/routes`
- Never hardcode route paths
- Example:
```tsx
import { ROUTES } from '@/lib/constants/routes';

router.push(ROUTES.TASKS);
<Link href={ROUTES.AUTH}>Sign In</Link>
```

## Constants Usage Guidelines

### When to Use Constants
- Routes: **ALWAYS** use constants
- Toast messages: **ALWAYS** use constants
- Configuration values (delays, thresholds): **ALWAYS** use constants
- Values used in 2+ places: Use constants
- Values likely to change: Use constants

### When NOT to Use Constants
- Placeholder text in forms
- One-off UI text
- Component-specific strings
- Static content that won't change

### Example
```tsx
// ✅ CORRECT
import { ROUTES } from '@/lib/constants/routes';
import { TOAST_MESSAGES } from '@/lib/constants/toast-messages';
import { CONFIG } from '@/lib/constants/config';

router.push(ROUTES.TASKS);
toast.success(TOAST_MESSAGES.AUTH.SIGN_IN_SUCCESS);
setTimeout(() => {}, CONFIG.REDIRECT_DELAY);

// ❌ WRONG
router.push('/tasks');
toast.success('Successfully signed in!');
setTimeout(() => {}, 300);
```

## Questions or Additions?

When in doubt:
1. Check existing patterns in the codebase
2. Prioritize consistency over cleverness
3. Use variants for reusable patterns
4. Use constants for routes, messages, and config
5. Ensure dark mode compatibility
6. Test in both themes
7. Keep code clean and simple

## Version Control

This file should be updated when:
- New component variants are added
- New patterns are established
- Breaking changes are made to existing patterns
- New best practices are adopted
- New constants are added

---

**Last Updated**: December 2024
**Maintained by**: TaskDesk Development Team

